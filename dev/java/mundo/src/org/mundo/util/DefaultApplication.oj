/*
 * The contents of this file are subject to the Mozilla Public License Version
 * 1.1 (the "License"); you may not use this file except in compliance with
 * the License. You may obtain a copy of the License at
 * http://www.mozilla.org/MPL/
 *
 * Software distributed under the License is distributed on an "AS IS" basis,
 * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License
 * for the specific language governing rights and limitations under the
 * License.
 *
 * The Original Code is MundoCore Java.
 *
 * The Initial Developer of the Original Code is Telecooperation Group,
 * Department of Computer Science, Darmstadt University of Technology.
 * Portions created by the Initial Developer are
 * Copyright (C) 2001-2008 the Initial Developer. All Rights Reserved.
 *
 * Contributor(s):
 * Erwin Aitenbichler
 */

package org.mundo.util;

import java.io.IOException;
import java.io.InputStreamReader;
import org.mundo.rt.Service;
import org.mundo.rt.Mundo;
import org.mundo.rt.Logger;

/**
 * A framework to create simple console-based applications.
 */
public class DefaultApplication extends Service
{
  public static void pause(String s)
  {
    System.out.println(s);
#ifndef CFG_CLDC
    try
    {
      System.in.read();
    }
    catch(IOException x)
    {
      Logger.global.exception(x);
      // If we get an IOException this usually means that there is no console.
      // In this case we simply wait forever.
#endif
      try
      {
        for(;;)
          Thread.sleep(10000);
      }
      catch(InterruptedException x2)
      {
        Logger.global.exception(x2);
      }
#ifndef CFG_CLDC
    }
#endif
  }
  public static void pause()
  {
#ifndef CFG_CLDC
    pause("hit enter to exit");
#else
    pause("press Ctrl+C to exit");
#endif
  }
  public void run() throws Exception
  {
    pause();
  }
  public static void start(DefaultApplication app)
  {
    Mundo.init();
    if (app!=null)
      Mundo.registerService(app);
    try
    {
      if (app!=null)
        app.run();
      else
        pause();
    }
    catch(Exception x)
    {
      x.printStackTrace();
    }
    Mundo.shutdown();
  }
  public static void main(String args[])
  {
    Mundo.init();
    pause();
    Mundo.shutdown();
  }
}
